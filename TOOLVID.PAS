(*********************************************************)
(*                                                       *)
(*               Malte Genesis/Tools Video               *)
(*     Phoenix Editor for Real Mode & Protected Mode     *)
(*                  II - Version 1.8                     *)
(*                      1994/12/29                       *)
(*                                                       *)
(*      Copyright (C) par les Chevaliers de Malte        *)
(*                                                       *)
(*********************************************************)

Unit ToolVid;

INTERFACE

{$IFDEF Overlay}
 {$O+}
 {$F+}
{$ENDIF}

Uses Video,Dials;

Const

      MtxMonochrome = 0;
      MtxBlackWhite = 1;
      MtxBlueCGA    = 2;
      MtxBleuet     = 3;
      MtxMagenta    = 4;
      MtxDiablo     = 5;

Var Colors : Array[0..5] of MatrixColors;

Procedure InitColorsDefault;
Procedure VideoInfo;
Procedure VideoSetup;

Function SelectVideoCard(X1,Y1,X2,Y2:Byte):Byte;
Function SelectVideoMode(X1,Y1,X2,Y2:Byte;ModeType:VideoModeType):Word;

IMPLEMENTATION

Uses RLL,Strs,Terminal,Math,CardVideo,LibVideo,Strings,Mems,Memorys,
     Images,Systems,Windows,MLibrary;

Procedure InitColorsDefault;
Begin
 With Colors[MtxMonochrome] do
 Begin
  Name := 'Monochrome';
  Menu.Normal               := (White        shl 4) + Black;
  Menu.High                 := (White        shl 4) + LightGray;
  Menu.Select               := (Black        shl 4) + White;
  Dialog.Wins.Title         := (White        shl 4) + Black;
  Dialog.Wins.Border        := (LightGray    shl 4) + White;
  Dialog.Wins.Icon          := (Black        shl 4) + White;
  Dialog.Wins.Sel           := (White        shl 4) + Black;
  Dialog.Wins.High          := (LightBlue    shl 4) + LightCyan;
  Dialog.Wins.Key           := (White        shl 4) + Black;
  Dialog.Wins.kShade        := (LightBlue    shl 4) + Black;
  Dialog.Wins.kSel          := (White        shl 4) + LightRed;
  Dialog.Env.BarSelInactive := (Blue         shl 4) + White;
  Dialog.Env.BarSelect      := (DarkGray     shl 4) + White;
  ErrorWin.Wins.Border      := (LightRed     shl 4) + White;
  ErrorWin.Wins.Title       := (White        shl 4) + LightBlue;
  ErrorWin.Wins.Msg         := (LightRed     shl 4) + Yellow;
  ErrorWin.Wins.KeyActif    := (White        shl 4) + LightRed;
  ErrorWin.Wins.KeyUnactif  := (White        shl 4) + Black;
  ErrorWin.Wins.KeyShade    := (LightRed     shl 4) + DarkGray;
  ErrorWin.Env.Input        := (LightRed     shl 4) + Red;
  WarningWin.Border         := (Yellow       shl 4) + White;
  WarningWin.Title          := (White        shl 4) + LightBlue;
  WarningWin.Msg            := (Yellow       shl 4) + Black;
  WarningWin.KeyActif       := (White        shl 4) + LightRed;
  WarningWin.KeyUnactif     := (White        shl 4) + Black;
  WarningWin.KeyShade       := (Yellow       shl 4) + DarkGray;
  RemWin.Border             := (LightBlue    shl 4) + White;
  RemWin.Title              := (White        shl 4) + Black;
  RemWin.Msg                := (LightBlue    shl 4) + LightCyan;
  RemWin.KeyActif           := (White        shl 4) + LightRed;
  RemWin.KeyUnactif         := (White        shl 4) + Black;
  RemWin.KeyShade           := (LightBlue    shl 4) + Black;
  OpenWin.Wins.Title        := (White        shl 4) + Black;
  OpenWin.Wins.Border       := (LightBlue    shl 4) + White;
  OpenWin.Wins.Icon         := (Black        shl 4) + White;
  OpenWin.Wins.Sel          := (Blue         shl 4) + White;
  OpenWin.Wins.High         := (LightBlue    shl 4) + LightCyan;
  OpenWin.Wins.Key          := (White        shl 4) + Black;
  OpenWin.Wins.kShade       := (LightBlue    shl 4) + Black;
  OpenWin.Wins.kSel         := (White        shl 4) + LightRed;
  OpenWin.Env.Input         := (Blue         shl 4) + White;
  OpenWin.Env.Dir           := (Blue         shl 4) + Yellow;
  MalteDos.Wins.Title       := (White        shl 4) + Black;
  MalteDos.Wins.Border      := (LightBlue    shl 4) + White;
  MalteDos.Wins.Icon        := (Black        shl 4) + White;
  MalteDos.Wins.Sel         := (Blue         shl 4) + White;
  MalteDos.Wins.High        := (LightBlue    shl 4) + LightCyan;
  MalteDos.Wins.Key         := (White        shl 4) + Black;
  MalteDos.Wins.kShade      := (LightBlue    shl 4) + Black;
  MalteDos.Wins.kSel        := (White        shl 4) + LightRed;
  MalteDos.Env.Default      := (Black        shl 4) + LightGray;
  MalteDos.Env.Prompt       := (Black        shl 4) + LightGreen;
  Editor.Wins.Border        := (LightBlue    shl 4) + White;
  Editor.Wins.Title         := (LightCyan    shl 4) + Black;
  Editor.Wins.Sel           := (Blue         shl 4) + White;
  Editor.Wins.High          := (LightBlue    shl 4) + LightCyan;
  Editor.Wins.kSel          := (White        shl 4) + LightRed;
  Editor.Wins.Key           := (White        shl 4) + Black;
  Editor.Wins.kShade        := (LightBlue    shl 4) + Black;
  Editor.Env.BarInfo        := (LightCyan    shl 4) + Black;
  Editor.Env.Default        := (Blue         shl 4) + LightMagenta;
  Editor.Env.Rem            := (Blue         shl 4) + Yellow;
  Editor.Env.ResWord        := (Blue         shl 4) + White;
  Editor.Env.Chars          := (Blue         shl 4) + LightRed;
  Editor.Env.Symbol         := (Blue         shl 4) + LightCyan;
  Editor.Env.AsmInst        := (Blue         shl 4) + LightGreen;
  Editor.Env.Number         := (Blue         shl 4) + LightBlue;
  Editor.Env.Z              := (LightMagenta shl 4) + Blue;
  Editor.Env.Normal         := (Blue         shl 4) + White;
  Editor.Env.Pos            := (LightCyan    shl 4) + Blue;
  Editor.Env.Insert         := (LightCyan    shl 4) + LightMagenta;
  Editor.Env.Modified       := (LightCyan    shl 4) + LightRed;
  PersonalJournal.Wins.Title  := (LightMagenta shl 4) + Black;
  PersonalJournal.Wins.Border := (Magenta      shl 4) + LightMagenta;
  PersonalJournal.Wins.Icon   := (Black        shl 4) + White;
  PersonalJournal.Wins.Sel    := (LightMagenta shl 4) + White;
  PersonalJournal.Wins.High   := (Blue         shl 4) + LightCyan;
  PersonalJournal.Wins.Key    := (White        shl 4) + Black;
  PersonalJournal.Wins.kShade := (Blue         shl 4) + Black;
  PersonalJournal.Wins.kSel   := (White        shl 4) + LightRed;
  PersonalJournal.Env.BarInfo := (LightMagenta shl 4) + Magenta;
  PersonalJournal.Env.Default := (Magenta      shl 4) + LightMagenta;
  PersonalJournal.Env.Pos     := (LightMagenta shl 4) + Magenta;
  PersonalJournal.Env.Insert  := (LightMagenta shl 4) + Magenta;
  ViewAscii.Wins.Border       := (LightBlue    shl 4) + White;
  ViewAscii.Wins.Title        := (White        shl 4) + Black;
  ViewAscii.Wins.Sel          := (Blue         shl 4) + White;
  ViewAscii.Wins.High         := (LightBlue    shl 4) + LightCyan;
  ViewAscii.Wins.kSel         := (White        shl 4) + LightRed;
  ViewAscii.Wins.Key          := (White        shl 4) + Black;
  ViewAscii.Wins.kShade       := (LightBlue    shl 4) + Black;
  ViewAscii.Env.BarInfo       := (LightCyan    shl 4) + Black;
  ViewAscii.Env.Default       := (Blue         shl 4) + LightMagenta;
  ViewAscii.Env.Rem           := (Blue         shl 4) + Yellow;
  ViewAscii.Env.ResWord       := (Blue         shl 4) + White;
  ViewAscii.Env.Chars         := (Blue         shl 4) + LightRed;
  ViewAscii.Env.Symbol        := (Blue         shl 4) + LightCyan;
  ViewAscii.Env.AsmInst       := (Blue         shl 4) + LightGreen;
  ViewAscii.Env.Number        := (Blue         shl 4) + LightBlue;
  ViewAscii.Env.Z             := (LightMagenta shl 4) + Blue;
  ViewAscii.Env.Normal        := (Blue         shl 4) + White;
  ViewAscii.Env.Pos           := (LightCyan    shl 4) + Blue;
  ViewAscii.Env.Insert        := (LightCyan    shl 4) + LightMagenta;
  ViewAscii.Env.Modified      := (LightCyan    shl 4) + LightRed;
  HexView.Wins.Title  := (White        shl 4) + Black;
  HexView.Wins.Border := (LightBlue    shl 4) + White;
  HexView.Wins.Icon   := (Black        shl 4) + White;
  HexView.Wins.Sel    := (Blue         shl 4) + White;
  HexView.Wins.High   := (LightBlue    shl 4) + LightCyan;
  HexView.Wins.Key    := (White        shl 4) + Black;
  HexView.Wins.kShade := (LightBlue    shl 4) + Black;
  HexView.Wins.kSel   := (White        shl 4) + LightRed;
  HexView.Env.Input   := (Blue         shl 4) + White;
  EditButt.Title  := (White        shl 4) + Black;
  EditButt.Border := (LightBlue    shl 4) + White;
  EditButt.Icon   := (Black        shl 4) + White;
  EditButt.Sel    := (Blue         shl 4) + White;
  EditButt.High   := (LightBlue    shl 4) + LightCyan;
  EditButt.Key    := (White        shl 4) + Black;
  EditButt.kShade := (LightBlue    shl 4) + Black;
  EditButt.kSel   := (White        shl 4) + LightRed;
  Dial.Wins.Title      := (White        shl 4) + Black;
  Dial.Wins.Border     := (LightBlue    shl 4) + White;
  Dial.Wins.Icon       := (Black        shl 4) + White;
  Dial.Wins.Sel        := (Blue         shl 4) + White;
  Dial.Wins.High       := (LightBlue    shl 4) + LightCyan;
  Dial.Wins.Key        := (White        shl 4) + Black;
  Dial.Wins.kShade     := (LightBlue    shl 4) + Black;
  Dial.Wins.kSel       := (White        shl 4) + LightRed;
  Dial.Env.BarUnselect := (LightBlue    shl 4) + White;
  Dial.Env.BarSelect   := (Blue         shl 4) + White;
  Draw.Wins.Title      := (White        shl 4) + Black;
  Draw.Wins.Border     := (LightBlue    shl 4) + White;
  Draw.Wins.Icon       := (Black        shl 4) + White;
  Draw.Wins.Sel        := (Blue         shl 4) + White;
  Draw.Wins.High       := (LightBlue    shl 4) + LightCyan;
  Draw.Wins.Key        := (White        shl 4) + Black;
  Draw.Wins.kShade     := (LightBlue    shl 4) + Black;
  Draw.Wins.kSel       := (White        shl 4) + LightRed;
 End;
 With Colors[MtxBlackWhite] do
 Begin
  Name := 'Noir & Blanc';
  Menu.Normal               := (White        shl 4) + Black;
  Menu.High                 := (White        shl 4) + LightGray;
  Menu.Select               := (Black        shl 4) + White;
  Dialog.Wins.Title         := (White        shl 4) + Black;
  Dialog.Wins.Border        := (LightGray    shl 4) + White;
  Dialog.Wins.Icon          := (Black        shl 4) + White;
  Dialog.Wins.Sel           := (White        shl 4) + Black;
  Dialog.Wins.High          := (LightBlue    shl 4) + LightCyan;
  Dialog.Wins.Key           := (White        shl 4) + Black;
  Dialog.Wins.kShade        := (LightBlue    shl 4) + Black;
  Dialog.Wins.kSel          := (White        shl 4) + LightRed;
  Dialog.Env.BarSelInactive := (Blue         shl 4) + White;
  Dialog.Env.BarSelect      := (DarkGray     shl 4) + White;
  ErrorWin.Wins.Border      := (LightRed     shl 4) + White;
  ErrorWin.Wins.Title       := (White        shl 4) + LightBlue;
  ErrorWin.Wins.Msg         := (LightRed     shl 4) + Yellow;
  ErrorWin.Wins.KeyActif    := (White        shl 4) + LightRed;
  ErrorWin.Wins.KeyUnactif  := (White        shl 4) + Black;
  ErrorWin.Wins.KeyShade    := (LightRed     shl 4) + DarkGray;
  ErrorWin.Env.Input        := (LightRed     shl 4) + Red;
  WarningWin.Border         := (Yellow       shl 4) + White;
  WarningWin.Title          := (White        shl 4) + LightBlue;
  WarningWin.Msg            := (Yellow       shl 4) + Black;
  WarningWin.KeyActif       := (White        shl 4) + LightRed;
  WarningWin.KeyUnactif     := (White        shl 4) + Black;
  WarningWin.KeyShade       := (Yellow       shl 4) + DarkGray;
  RemWin.Border             := (LightBlue    shl 4) + White;
  RemWin.Title              := (White        shl 4) + Black;
  RemWin.Msg                := (LightBlue    shl 4) + LightCyan;
  RemWin.KeyActif           := (White        shl 4) + LightRed;
  RemWin.KeyUnactif         := (White        shl 4) + Black;
  RemWin.KeyShade           := (LightBlue    shl 4) + Black;
  OpenWin.Wins.Title        := (White        shl 4) + Black;
  OpenWin.Wins.Border       := (LightBlue    shl 4) + White;
  OpenWin.Wins.Icon         := (Black        shl 4) + White;
  OpenWin.Wins.Sel          := (Blue         shl 4) + White;
  OpenWin.Wins.High         := (LightBlue    shl 4) + LightCyan;
  OpenWin.Wins.Key          := (White        shl 4) + Black;
  OpenWin.Wins.kShade       := (LightBlue    shl 4) + Black;
  OpenWin.Wins.kSel         := (White        shl 4) + LightRed;
  OpenWin.Env.Input         := (Blue         shl 4) + White;
  OpenWin.Env.Dir           := (Blue         shl 4) + Yellow;
  MalteDos.Wins.Title       := (White        shl 4) + Black;
  MalteDos.Wins.Border      := (LightBlue    shl 4) + White;
  MalteDos.Wins.Icon        := (Black        shl 4) + White;
  MalteDos.Wins.Sel         := (Blue         shl 4) + White;
  MalteDos.Wins.High        := (LightBlue    shl 4) + LightCyan;
  MalteDos.Wins.Key         := (White        shl 4) + Black;
  MalteDos.Wins.kShade      := (LightBlue    shl 4) + Black;
  MalteDos.Wins.kSel        := (White        shl 4) + LightRed;
  MalteDos.Env.Default      := (Black        shl 4) + LightGray;
  MalteDos.Env.Prompt       := (Black        shl 4) + LightGreen;
  Editor.Wins.Border        := (LightBlue    shl 4) + White;
  Editor.Wins.Title         := (LightCyan    shl 4) + Black;
  Editor.Wins.Sel           := (Blue         shl 4) + White;
  Editor.Wins.High          := (LightBlue    shl 4) + LightCyan;
  Editor.Wins.kSel          := (White        shl 4) + LightRed;
  Editor.Wins.Key           := (White        shl 4) + Black;
  Editor.Wins.kShade        := (LightBlue    shl 4) + Black;
  Editor.Env.BarInfo        := (LightCyan    shl 4) + Black;
  Editor.Env.Default        := (Blue         shl 4) + LightMagenta;
  Editor.Env.Rem            := (Blue         shl 4) + Yellow;
  Editor.Env.ResWord        := (Blue         shl 4) + White;
  Editor.Env.Chars          := (Blue         shl 4) + LightRed;
  Editor.Env.Symbol         := (Blue         shl 4) + LightCyan;
  Editor.Env.AsmInst        := (Blue         shl 4) + LightGreen;
  Editor.Env.Number         := (Blue         shl 4) + LightBlue;
  Editor.Env.Z              := (LightMagenta shl 4) + Blue;
  Editor.Env.Normal         := (Blue         shl 4) + White;
  Editor.Env.Pos            := (LightCyan    shl 4) + Blue;
  Editor.Env.Insert         := (LightCyan    shl 4) + LightMagenta;
  Editor.Env.Modified       := (LightCyan    shl 4) + LightRed;
  PersonalJournal.Wins.Title  := (LightMagenta shl 4) + Black;
  PersonalJournal.Wins.Border := (Magenta      shl 4) + LightMagenta;
  PersonalJournal.Wins.Icon   := (Black        shl 4) + White;
  PersonalJournal.Wins.Sel    := (LightMagenta shl 4) + White;
  PersonalJournal.Wins.High   := (Blue         shl 4) + LightCyan;
  PersonalJournal.Wins.Key    := (White        shl 4) + Black;
  PersonalJournal.Wins.kShade := (Blue         shl 4) + Black;
  PersonalJournal.Wins.kSel   := (White        shl 4) + LightRed;
  PersonalJournal.Env.BarInfo := (LightMagenta shl 4) + Magenta;
  PersonalJournal.Env.Default := (Magenta      shl 4) + LightMagenta;
  PersonalJournal.Env.Pos     := (LightMagenta shl 4) + Magenta;
  PersonalJournal.Env.Insert  := (LightMagenta shl 4) + Magenta;
  ViewAscii.Wins.Border       := (LightBlue    shl 4) + White;
  ViewAscii.Wins.Title        := (White        shl 4) + Black;
  ViewAscii.Wins.Sel          := (Blue         shl 4) + White;
  ViewAscii.Wins.High         := (LightBlue    shl 4) + LightCyan;
  ViewAscii.Wins.kSel         := (White        shl 4) + LightRed;
  ViewAscii.Wins.Key          := (White        shl 4) + Black;
  ViewAscii.Wins.kShade       := (LightBlue    shl 4) + Black;
  ViewAscii.Env.BarInfo       := (LightCyan    shl 4) + Black;
  ViewAscii.Env.Default       := (Blue         shl 4) + LightMagenta;
  ViewAscii.Env.Rem           := (Blue         shl 4) + Yellow;
  ViewAscii.Env.ResWord       := (Blue         shl 4) + White;
  ViewAscii.Env.Chars         := (Blue         shl 4) + LightRed;
  ViewAscii.Env.Symbol        := (Blue         shl 4) + LightCyan;
  ViewAscii.Env.AsmInst       := (Blue         shl 4) + LightGreen;
  ViewAscii.Env.Number        := (Blue         shl 4) + LightBlue;
  ViewAscii.Env.Z             := (LightMagenta shl 4) + Blue;
  ViewAscii.Env.Normal        := (Blue         shl 4) + White;
  ViewAscii.Env.Pos           := (LightCyan    shl 4) + Blue;
  ViewAscii.Env.Insert        := (LightCyan    shl 4) + LightMagenta;
  ViewAscii.Env.Modified      := (LightCyan    shl 4) + LightRed;
  HexView.Wins.Title        := (White        shl 4) + Black;
  HexView.Wins.Border       := (LightBlue    shl 4) + White;
  HexView.Wins.Icon         := (Black        shl 4) + White;
  HexView.Wins.Sel          := (Blue         shl 4) + White;
  HexView.Wins.High         := (LightBlue    shl 4) + LightCyan;
  HexView.Wins.Key          := (White        shl 4) + Black;
  HexView.Wins.kShade       := (LightBlue    shl 4) + Black;
  HexView.Wins.kSel         := (White        shl 4) + LightRed;
  HexView.Env.Input         := (Blue         shl 4) + White;
  EditButt.Title       := (White        shl 4) + Black;
  EditButt.Border      := (LightBlue    shl 4) + White;
  EditButt.Icon        := (Black        shl 4) + White;
  EditButt.Sel         := (Blue         shl 4) + White;
  EditButt.High        := (LightBlue    shl 4) + LightCyan;
  EditButt.Key         := (White        shl 4) + Black;
  EditButt.kShade      := (LightBlue    shl 4) + Black;
  EditButt.kSel        := (White        shl 4) + LightRed;
  Dial.Wins.Title         := (White        shl 4) + Black;
  Dial.Wins.Border        := (LightBlue    shl 4) + White;
  Dial.Wins.Icon          := (Black        shl 4) + White;
  Dial.Wins.Sel           := (Blue         shl 4) + White;
  Dial.Wins.High          := (LightBlue    shl 4) + LightCyan;
  Dial.Wins.Key           := (White        shl 4) + Black;
  Dial.Wins.kShade        := (LightBlue    shl 4) + Black;
  Dial.Wins.kSel          := (White        shl 4) + LightRed;
  Dial.Env.BarUnselect    := (LightBlue    shl 4) + White;
  Dial.Env.BarSelect      := (Blue         shl 4) + White;
  Draw.Wins.Title         := (White        shl 4) + Black;
  Draw.Wins.Border        := (LightBlue    shl 4) + White;
  Draw.Wins.Icon          := (Black        shl 4) + White;
  Draw.Wins.Sel           := (Blue         shl 4) + White;
  Draw.Wins.High          := (LightBlue    shl 4) + LightCyan;
  Draw.Wins.Key           := (White        shl 4) + Black;
  Draw.Wins.kShade        := (LightBlue    shl 4) + Black;
  Draw.Wins.kSel          := (White        shl 4) + LightRed;
 End;
 With Colors[MtxBlueCGA] do
 Begin
  Name := 'Bleu & Dilu‚e';
  Menu.Normal        := (Cyan         shl 4) + White;
  Menu.High          := (Cyan         shl 4) + LightCyan;
  Menu.Select        := (Magenta      shl 4) + Yellow;
  Dialog.Wins.Title  := (Green        shl 4) + Yellow;
  Dialog.Wins.Border := (Green        shl 4) + White;
  Dialog.Wins.Icon   := (Green        shl 4) + LightGreen;
  Dialog.Wins.Sel    := (Magenta      shl 4) + Yellow;
  Dialog.Wins.High   := (Green        shl 4) + LightCyan;
  Dialog.Wins.Key    := (Cyan         shl 4) + White;
  Dialog.Wins.kShade := (Green        shl 4) + Black;
  Dialog.Wins.kSel   := (Cyan         shl 4) + Yellow;
  Dialog.Env.BarSelInactive := (Magenta      shl 4) + White;
  Dialog.Env.BarSelect      := (Magenta      shl 4) + Yellow;
  ErrorWin.Wins.Border      := (Red          shl 4) + White;
  ErrorWin.Wins.Title       := (Red          shl 4) + Yellow;
  ErrorWin.Wins.Msg         := (Red          shl 4) + Yellow;
  ErrorWin.Wins.KeyActif    := (Cyan         shl 4) + Yellow;
  ErrorWin.Wins.KeyUnactif  := (Cyan         shl 4) + White;
  ErrorWin.Wins.KeyShade    := (Red          shl 4) + Black;
  ErrorWin.Env.Input        := (Blue         shl 4) + LightCyan;
  WarningWin.Border         := (Brown        shl 4) + White;
  WarningWin.Title          := (Brown        shl 4) + Yellow;
  WarningWin.Msg            := (Brown        shl 4) + Yellow;
  WarningWin.KeyActif       := (Cyan         shl 4) + Yellow;
  WarningWin.KeyUnactif     := (Cyan         shl 4) + White;
  WarningWin.KeyShade       := (Brown        shl 4) + Black;
  RemWin.Border             := (Green        shl 4) + White;
  RemWin.Title              := (Green        shl 4) + Yellow;
  RemWin.Msg                := (Green        shl 4) + LightCyan;
  RemWin.KeyActif           := (Cyan         shl 4) + Yellow;
  RemWin.KeyUnactif         := (Cyan         shl 4) + White;
  RemWin.KeyShade           := (Green        shl 4) + Black;
  OpenWin.Wins.Title        := (Green        shl 4) + Yellow;
  OpenWin.Wins.Border       := (Green        shl 4) + White;
  OpenWin.Wins.Icon         := (Green        shl 4) + LightGreen;
  OpenWin.Wins.Sel          := (Magenta      shl 4) + Yellow;
  OpenWin.Wins.High         := (Green        shl 4) + LightCyan;
  OpenWin.Wins.Key          := (Cyan         shl 4) + White;
  OpenWin.Wins.kShade       := (Green        shl 4) + Black;
  OpenWin.Wins.kSel         := (Cyan         shl 4) + Yellow;
  OpenWin.Env.Input         := (Blue         shl 4) + White;
  OpenWin.Env.Dir           := (Blue         shl 4) + Yellow;
  MalteDos.Wins.Title       := (Black        shl 4) + Yellow;
  MalteDos.Wins.Border      := (Black        shl 4) + White;
  MalteDos.Wins.Icon        := (Black        shl 4) + White;
  MalteDos.Wins.Sel         := (Black        shl 4) + LightCyan;
  MalteDos.Wins.High        := (Black        shl 4) + LightBlue;
  MalteDos.Wins.Key         := (Cyan         shl 4) + White;
  MalteDos.Wins.kShade      := (Black        shl 4) + Black;
  MalteDos.Wins.kSel        := (Cyan         shl 4) + Yellow;
  MalteDos.Env.Default      := (Black        shl 4) + LightGray;
  MalteDos.Env.Prompt       := (Black        shl 4) + LightGreen;
  Editor.Wins.Border        := (Blue         shl 4) + White;
  Editor.Wins.Title         := (Blue         shl 4) + Yellow;
  Editor.Wins.Sel           := (Magenta      shl 4) + Yellow;
  Editor.Wins.High          := (Blue         shl 4) + LightCyan;
  Editor.Wins.kSel          := (Cyan         shl 4) + Yellow;
  Editor.Wins.Key           := (Cyan         shl 4) + White;
  Editor.Wins.kShade        := (Blue         shl 4) + Black;
  Editor.Env.BarInfo        := (LightCyan    shl 4) + Black;
  Editor.Env.Default        := (Blue         shl 4) + LightMagenta;
  Editor.Env.Rem            := (Blue         shl 4) + Yellow;
  Editor.Env.ResWord        := (Blue         shl 4) + White;
  Editor.Env.Chars          := (Blue         shl 4) + LightRed;
  Editor.Env.Symbol         := (Blue         shl 4) + LightCyan;
  Editor.Env.AsmInst        := (Blue         shl 4) + LightGreen;
  Editor.Env.Number         := (Blue         shl 4) + LightBlue;
  Editor.Env.Z              := (LightMagenta shl 4) + Blue;
  Editor.Env.Normal         := (Blue         shl 4) + White;
  Editor.Env.Pos            := (Cyan         shl 4) + Blue;
  Editor.Env.Insert         := (Cyan         shl 4) + LightMagenta;
  Editor.Env.Modified       := (Cyan         shl 4) + LightRed;
  PersonalJournal.Wins.Title  := (Magenta      shl 4) + Black;
  PersonalJournal.Wins.Border := (Magenta      shl 4) + LightMagenta;
  PersonalJournal.Wins.Icon   := (Black        shl 4) + White;
  PersonalJournal.Wins.Sel    := (Blue         shl 4) + White;
  PersonalJournal.Wins.High   := (Magenta      shl 4) + LightCyan;
  PersonalJournal.Wins.Key    := (Cyan         shl 4) + White;
  PersonalJournal.Wins.kShade := (Magenta      shl 4) + Black;
  PersonalJournal.Wins.kSel   := (Cyan         shl 4) + Yellow;
  PersonalJournal.Env.BarInfo    := (Red          shl 4) + Magenta;
  PersonalJournal.Env.Default    := (Magenta      shl 4) + LightMagenta;
  PersonalJournal.Env.Pos        := (Red          shl 4) + Magenta;
  PersonalJournal.Env.Insert     := (Red          shl 4) + Magenta;
  ViewAscii.Wins.Border          := (Blue         shl 4) + White;
  ViewAscii.Wins.Title           := (Blue         shl 4) + Yellow;
  ViewAscii.Wins.Sel             := (Magenta      shl 4) + White;
  ViewAscii.Wins.High            := (Blue         shl 4) + LightCyan;
  ViewAscii.Wins.kSel            := (Cyan         shl 4) + Yellow;
  ViewAscii.Wins.Key             := (Cyan         shl 4) + White;
  ViewAscii.Wins.kShade          := (Blue         shl 4) + Black;
  ViewAscii.Env.BarInfo          := (Cyan         shl 4) + Black;
  ViewAscii.Env.Default          := (Blue         shl 4) + LightMagenta;
  ViewAscii.Env.Rem              := (Blue         shl 4) + Yellow;
  ViewAscii.Env.ResWord          := (Blue         shl 4) + White;
  ViewAscii.Env.Chars            := (Blue         shl 4) + LightRed;
  ViewAscii.Env.Symbol           := (Blue         shl 4) + LightCyan;
  ViewAscii.Env.AsmInst          := (Blue         shl 4) + LightGreen;
  ViewAscii.Env.Number           := (Blue         shl 4) + LightBlue;
  ViewAscii.Env.Z                := (Magenta      shl 4) + Blue;
  ViewAscii.Env.Normal           := (Blue         shl 4) + White;
  ViewAscii.Env.Pos              := (Cyan         shl 4) + Blue;
  ViewAscii.Env.Insert           := (Cyan         shl 4) + LightMagenta;
  ViewAscii.Env.Modified         := (Cyan         shl 4) + LightRed;
  HexView.Wins.Title        := (Blue         shl 4) + Yellow;
  HexView.Wins.Border       := (Blue         shl 4) + White;
  HexView.Wins.Icon         := (Black        shl 4) + White;
  HexView.Wins.Sel          := (Magenta      shl 4) + Yellow;
  HexView.Wins.High         := (Blue         shl 4) + LightCyan;
  HexView.Wins.Key          := (Cyan         shl 4) + White;
  HexView.Wins.kShade       := (Blue         shl 4) + Black;
  HexView.Wins.kSel         := (Cyan         shl 4) + Yellow;
  HexView.Env.Input         := (Blue         shl 4) + White;
  EditButt.Title  := (Black        shl 4) + Yellow;
  EditButt.Border := (Black        shl 4) + White;
  EditButt.Icon   := (Black        shl 4) + White;
  EditButt.Sel    := (Magenta      shl 4) + Yellow;
  EditButt.High   := (LightBlue    shl 4) + LightCyan;
  EditButt.Key    := (Cyan         shl 4) + White;
  EditButt.kShade := (Black        shl 4) + Black;
  EditButt.kSel   := (Cyan         shl 4) + Yellow;
  Dial.Wins.Title  := (Blue         shl 4) + Yellow;
  Dial.Wins.Border := (Blue         shl 4) + White;
  Dial.Wins.Icon   := (Black        shl 4) + White;
  Dial.Wins.Sel    := (Magenta      shl 4) + Yellow;
  Dial.Wins.High   := (Blue         shl 4) + LightCyan;
  Dial.Wins.Key    := (Cyan         shl 4) + White;
  Dial.Wins.kShade := (Blue         shl 4) + Black;
  Dial.Wins.kSel   := (Cyan         shl 4) + Yellow;
  Dial.Env.BarUnselect    := (Blue         shl 4) + LightCyan;
  Dial.Env.BarSelect      := (Magenta      shl 4) + Yellow;
  Draw.Wins.Title  := (Black        shl 4) + Yellow;
  Draw.Wins.Border := (Black        shl 4) + White;
  Draw.Wins.Icon   := (Black        shl 4) + White;
  Draw.Wins.Sel    := (Magenta      shl 4) + Yellow;
  Draw.Wins.High   := (Black        shl 4) + LightCyan;
  Draw.Wins.Key    := (Cyan         shl 4) + White;
  Draw.Wins.kShade := (Black        shl 4) + Black;
  Draw.Wins.kSel   := (Cyan         shl 4) + Yellow;
 End;
 With Colors[MtxBleuet] do
 Begin
  Name               := 'Bleuet';
  Menu.Normal        := (White        shl 4) + Black;
  Menu.High          := (White        shl 4) + LightRed;
  Menu.Select        := (Black        shl 4) + White;
  Dialog.Wins.Title  := (White        shl 4) + Black;
  Dialog.Wins.Border := (LightBlue    shl 4) + White;
  Dialog.Wins.Icon   := (Black        shl 4) + White;
  Dialog.Wins.Sel    := (Blue         shl 4) + White;
  Dialog.Wins.High   := (LightBlue    shl 4) + LightCyan;
  Dialog.Wins.Key    := (White        shl 4) + Black;
  Dialog.Wins.kShade := (LightBlue    shl 4) + Black;
  Dialog.Wins.kSel   := (White        shl 4) + LightRed;
  Dialog.Env.BarSelInactive := (Blue         shl 4) + White;
  Dialog.Env.BarSelect      := (DarkGray     shl 4) + White;
  ErrorWin.Wins.Border      := (LightRed     shl 4) + White;
  ErrorWin.Wins.Title       := (White        shl 4) + LightBlue;
  ErrorWin.Wins.Msg         := (LightRed     shl 4) + Yellow;
  ErrorWin.Wins.KeyActif    := (White        shl 4) + LightRed;
  ErrorWin.Wins.KeyUnactif  := (White        shl 4) + Black;
  ErrorWin.Wins.KeyShade    := (LightRed     shl 4) + DarkGray;
  ErrorWin.Env.Input        := (LightRed     shl 4) + Red;
  WarningWin.Border         := (Yellow       shl 4) + White;
  WarningWin.Title          := (White        shl 4) + LightBlue;
  WarningWin.Msg            := (Yellow       shl 4) + Black;
  WarningWin.KeyActif       := (White        shl 4) + LightRed;
  WarningWin.KeyUnactif     := (White        shl 4) + Black;
  WarningWin.KeyShade       := (Yellow       shl 4) + DarkGray;
  RemWin.Border             := (LightBlue    shl 4) + White;
  RemWin.Title              := (White        shl 4) + Black;
  RemWin.Msg                := (LightBlue    shl 4) + LightCyan;
  RemWin.KeyActif           := (White        shl 4) + LightRed;
  RemWin.KeyUnactif         := (White        shl 4) + Black;
  RemWin.KeyShade           := (LightBlue    shl 4) + Black;
  OpenWin.Wins.Title        := (White        shl 4) + Black;
  OpenWin.Wins.Border       := (LightBlue    shl 4) + White;
  OpenWin.Wins.Icon         := (Black        shl 4) + White;
  OpenWin.Wins.Sel          := (Blue         shl 4) + White;
  OpenWin.Wins.High         := (LightBlue    shl 4) + LightCyan;
  OpenWin.Wins.Key          := (White        shl 4) + Black;
  OpenWin.Wins.kShade       := (LightBlue    shl 4) + Black;
  OpenWin.Wins.kSel         := (White        shl 4) + LightRed;
  OpenWin.Env.Input         := (Blue         shl 4) + LightCyan;
  OpenWin.Env.Dir           := (Blue         shl 4) + Yellow;
  MalteDos.Wins.Title       := (White        shl 4) + Black;
  MalteDos.Wins.Border      := (Black        shl 4) + White;
  MalteDos.Wins.Icon        := (Black        shl 4) + White;
  MalteDos.Wins.Sel         := (Black        shl 4) + LightBlue;
  MalteDos.Wins.High        := (Black        shl 4) + LightCyan;
  MalteDos.Wins.Key         := (White        shl 4) + Black;
  MalteDos.Wins.kShade      := (Black        shl 4) + Black;
  MalteDos.Wins.kSel        := (White        shl 4) + LightRed;
  MalteDos.Env.Default      := (Black        shl 4) + LightGray;
  MalteDos.Env.Prompt       := (Black        shl 4) + LightGreen;
  Editor.Wins.Icon          := (Black        shl 4) + White;
  Editor.Wins.Border        := (Blue         shl 4) + White;
  Editor.Wins.Title         := (LightCyan    shl 4) + Black;
  Editor.Wins.Sel           := (Blue         shl 4) + White;
  Editor.Wins.High          := (LightBlue    shl 4) + LightCyan;
  Editor.Wins.kSel          := (White        shl 4) + LightRed;
  Editor.Wins.Key           := (White        shl 4) + Black;
  Editor.Wins.kShade        := (LightBlue    shl 4) + Black;
  Editor.Env.BarInfo        := (LightCyan    shl 4) + Black;
  Editor.Env.Default        := (Blue         shl 4) + LightMagenta;
  Editor.Env.Rem            := (Blue         shl 4) + Yellow;
  Editor.Env.ResWord        := (Blue         shl 4) + White;
  Editor.Env.Chars          := (Blue         shl 4) + LightRed;
  Editor.Env.Symbol         := (Blue         shl 4) + LightCyan;
  Editor.Env.AsmInst        := (Blue         shl 4) + LightGreen;
  Editor.Env.Number         := (Blue         shl 4) + LightBlue;
  Editor.Env.Z              := (LightMagenta shl 4) + Blue;
  Editor.Env.Normal         := (Blue         shl 4) + White;
  Editor.Env.Pos            := (LightCyan    shl 4) + Blue;
  Editor.Env.Insert         := (LightCyan    shl 4) + LightMagenta;
  Editor.Env.Modified       := (LightCyan    shl 4) + LightRed;
  PersonalJournal.Wins.Title  := (LightMagenta shl 4) + Black;
  PersonalJournal.Wins.Border := (Magenta      shl 4) + LightMagenta;
  PersonalJournal.Wins.Icon   := (Black        shl 4) + White;
  PersonalJournal.Wins.Sel    := (LightMagenta shl 4) + White;
  PersonalJournal.Wins.High   := (Blue         shl 4) + LightCyan;
  PersonalJournal.Wins.Key    := (White        shl 4) + Black;
  PersonalJournal.Wins.kShade := (Blue         shl 4) + Black;
  PersonalJournal.Wins.kSel   := (White        shl 4) + LightRed;
  PersonalJournal.Env.BarInfo := (LightMagenta shl 4) + Magenta;
  PersonalJournal.Env.Default := (Magenta      shl 4) + LightMagenta;
  PersonalJournal.Env.Pos     := (LightMagenta shl 4) + Magenta;
  PersonalJournal.Env.Insert  := (LightMagenta shl 4) + Magenta;
  ViewAscii.Wins.Border := (LightBlue    shl 4) + White;
  ViewAscii.Wins.Title  := (White        shl 4) + Black;
  ViewAscii.Wins.Sel    := (Blue         shl 4) + White;
  ViewAscii.Wins.High   := (LightBlue    shl 4) + LightCyan;
  ViewAscii.Wins.kSel   := (White        shl 4) + LightRed;
  ViewAscii.Wins.Key    := (White        shl 4) + Black;
  ViewAscii.Wins.kShade := (LightBlue    shl 4) + Black;
  ViewAscii.Env.BarInfo          := (LightCyan    shl 4) + Black;
  ViewAscii.Env.Default          := (Blue         shl 4) + LightMagenta;
  ViewAscii.Env.Rem              := (Blue         shl 4) + Yellow;
  ViewAscii.Env.ResWord          := (Blue         shl 4) + White;
  ViewAscii.Env.Chars            := (Blue         shl 4) + LightRed;
  ViewAscii.Env.Symbol           := (Blue         shl 4) + LightCyan;
  ViewAscii.Env.AsmInst          := (Blue         shl 4) + LightGreen;
  ViewAscii.Env.Number           := (Blue         shl 4) + LightBlue;
  ViewAscii.Env.Z                := (LightMagenta shl 4) + Blue;
  ViewAscii.Env.Normal           := (Blue         shl 4) + White;
  ViewAscii.Env.Pos              := (LightCyan    shl 4) + Blue;
  ViewAscii.Env.Insert           := (LightCyan    shl 4) + LightMagenta;
  ViewAscii.Env.Modified         := (LightCyan    shl 4) + LightRed;
  HexView.Wins.Title  := (White        shl 4) + Black;
  HexView.Wins.Border := (LightBlue    shl 4) + White;
  HexView.Wins.Icon   := (Black        shl 4) + White;
  HexView.Wins.Sel    := (Blue         shl 4) + White;
  HexView.Wins.High   := (LightBlue    shl 4) + LightCyan;
  HexView.Wins.Key    := (White        shl 4) + Black;
  HexView.Wins.kShade := (LightBlue    shl 4) + Black;
  HexView.Wins.kSel   := (White        shl 4) + LightRed;
  HexView.Env.Input   := (Blue         shl 4) + White;
  EditButt.Title  := (White        shl 4) + Black;
  EditButt.Border := (LightBlue    shl 4) + White;
  EditButt.Icon   := (Black        shl 4) + White;
  EditButt.Sel    := (Blue         shl 4) + White;
  EditButt.High   := (LightBlue    shl 4) + LightCyan;
  EditButt.Key    := (White        shl 4) + Black;
  EditButt.kShade := (LightBlue    shl 4) + Black;
  EditButt.kSel   := (White        shl 4) + LightRed;
  Dial.Wins.Title  := (White        shl 4) + Black;
  Dial.Wins.Border := (LightBlue    shl 4) + White;
  Dial.Wins.Icon   := (Black        shl 4) + White;
  Dial.Wins.Sel    := (Blue         shl 4) + White;
  Dial.Wins.High   := (LightBlue    shl 4) + LightCyan;
  Dial.Wins.Key    := (White        shl 4) + Black;
  Dial.Wins.kShade := (LightBlue    shl 4) + Black;
  Dial.Wins.kSel   := (White        shl 4) + LightRed;
  Dial.Env.BarUnselect := (LightBlue    shl 4) + White;
  Dial.Env.BarSelect   := (Blue         shl 4) + White;
  Draw.Wins.Title  := (White        shl 4) + Black;
  Draw.Wins.Border := (LightBlue    shl 4) + White;
  Draw.Wins.Icon   := (Black        shl 4) + White;
  Draw.Wins.Sel    := (Blue         shl 4) + White;
  Draw.Wins.High   := (LightBlue    shl 4) + LightCyan;
  Draw.Wins.Key    := (White        shl 4) + Black;
  Draw.Wins.kShade := (LightBlue    shl 4) + Black;
  Draw.Wins.kSel   := (White        shl 4) + LightRed;
  Help.Wins.Title  := (White        shl 4) + Black;
  Help.Wins.Border := (Black        shl 4) + White;
  Help.Wins.Icon   := (Black        shl 4) + White;
  Help.Wins.Sel    := (Black        shl 4) + LightBlue;
  Help.Wins.High   := (Black        shl 4) + LightCyan;
  Help.Wins.Key    := (White        shl 4) + Black;
  Help.Wins.kShade := (Black        shl 4) + Black;
  Help.Wins.kSel   := (White        shl 4) + LightRed;
 End;
End;

Function SelectVideoCard(X1,Y1,X2,Y2:Byte):Byte;
Var R:Byte; M:LstMnu; I:Byte; SizeOf_:Array[0..103] of Word;
    PChr:Array[0..103] of PChar;
Begin
 If Not(IsInitVideoData)Then
 Begin
  QuickInitVideo(True);
  SetBlinkEnv;
  SetBorderDouble;
 End;
 With M do
 Begin
  Init(X1,Y1,X2,Y2,'S‚lecte Carte Vid‚o',CurrColors.Dialog.Wins);
  For I := 0 to 103 do
  Begin
   PChr[I] := AllocFunc(I,SetPath4AddFile(StrPas(PathSystems))+'FRANCAIS.*',SizeOf_[I]);
   AddPChrByte(PChr[I],I);
  End;
  SelectVideoCard := vdUnknown;
  R := Run;
  For I := 0 to 103 do FreeMem(PChr[I],SizeOf_[I]);
  If(R > 0)Then
  Begin
   If(WarningMsgYesNo('Etˆs-vous certain de vouloir changer ' +
		      'la configuration de carte vid‚o ?') = kbYes)Then
    SelectVideoCard := R;
  End;
  Done;
 End;
End;

Function SelectVideoMode;
Var List:LstMnu; J,P,Y,I,Num:Byte; Size,K:Word; Ok:Bool;
    PCharWord:^PCharWordRec;
    ChkModeSupport:Procedure(Info1,Info2:PhysicalInfoVideo;Var Buf1,Buf2:PaletteMode);
    Ptr:Pointer Absolute ChkModeSupport;
    SizeOf_:Word; Mode,Mode2:PaletteMode;
Begin
 If Not(IsInitVideoData)Then
 Begin
  InitVideo;
  SetBlinkEnv;
  SetBorderDouble;
 End;
 With List do
 Begin
  Init(X1,Y1,X2,Y2,'S‚lecte Mode Vid‚o',CurrColors.Dialog.Wins);
  If((ModeType = __Text__)or(ModeType = __Two__))Then
  Begin
   Ptr := AllocMainFunc(142,SizeOf_);
   ChkModeSupport(_PVid1,_PVid2,Mode,Mode2);
   FreeMem(Ptr,SizeOf_);
   For I := 0 to 127 do
   Begin
    If(Mode[I] = _NoMode)Then Break;
    Case Mode[I] of
	_TextBW40 : AddModeTextWord(40,25,'B',_TextBW40);
	_TextBW80 : AddModeTextWord(80,25,'B',_TextBW80);
         _TextC40 : AddModeTextWord(40,25,'C',_TextC40);
         _TextC80 : AddModeTextWord(80,25,'C',_TextC80);
      _TextC80x30 : AddModeTextWord(80,30,'C',_TextC80x30);
      _TextC80x33 : AddModeTextWord(80,33,'C',_TextC80x33);
      _TextC80x34 : AddModeTextWord(80,34,'C',_TextC80x34);
      _TextC80x43 : AddModeTextWord(80,43,'C',_TextC80x43);
      _TextC80x50 : AddModeTextWord(80,50,'C',_TextC80x50);
      _TextC80x60 : AddModeTextWord(80,60,'C',_TextC80x60);
      _TextC80x66 : AddModeTextWord(80,66,'C',_TextC80x66);
     _TextC100x30 : AddModeTextWord(100,30,'C',_TextC100x30);
     _TextC100x40 : AddModeTextWord(100,40,'C',_TextC100x40);
     _TextC100x50 : AddModeTextWord(100,50,'C',_TextC100x50);
     _TextC100x60 : AddModeTextWord(100,60,'C',_TextC100x60);
     _TextC100x75 : AddModeTextWord(100,75,'C',_TextC100x75);
     _TextC120x25 : AddModeTextWord(120,25,'C',_TextC120x25);
     _TextC120x43 : AddModeTextWord(120,43,'C',_TextC120x43);
     _TextC132x25 : AddModeTextWord(132,25,'C',_TextC132x25);
     _TextC132x28 : AddModeTextWord(132,28,'C',_TextC132x28);
     _TextC132x30 : AddModeTextWord(132,30,'C',_TextC132x30);
     _TextC132x43 : AddModeTextWord(132,43,'C',_TextC132x43);
     _TextC132x44 : AddModeTextWord(132,44,'C',_TextC132x44);
     _TextC132x50 : AddModeTextWord(132,50,'C',_TextC132x50);
     _TextC132x60 : AddModeTextWord(132,60,'C',_TextC132x60);
     _TextC160x50 : AddModeTextWord(160,50,'C',_TextC160x50);
        _TextMono : AddModeTextWord(80,25,'M',_TextMono);
  _TextMono132x25 : AddModeTextWord(132,25,'M',_TextMono132x25);
  _TextMono132x28 : AddModeTextWord(132,28,'M',_TextMono132x28);
  _TextMono132x43 : AddModeTextWord(132,43,'M',_TextMono132x43);
  _TextMono132x44 : AddModeTextWord(132,44,'M',_TextMono132x44);
	       _Hercule : AddStrWord('Hercule (720x348)',_Hercule);
	_Graph240x128c2 : AddModeGrafWord(240,128,1,_Graph240x128c2);
        _Graph320x200c4 : AddModeGrafWord(320,200,2,_Graph320x200c4);
       _Graph320x200c16 : AddModeGrafWord(320,200,4,_Graph320x200c16);
      _Graph320x200c256 : AddModeGrafWord(320,200,8,_Graph320x200c256);
    _Graph320x200c32768 : AddModeGrafWord(320,200,15,_Graph320x200c32768);
    _Graph320x200c65536 : AddModeGrafWord(320,200,16,_Graph320x200c65536);
      _Graph320x400c256 : AddModeGrafWord(320,400,8,_Graph320x400c256);
      _Graph360x480c256 : AddModeGrafWord(360,480,8,_Graph360x480c256);
       _Graph512x512c16 : AddModeGrafWord(512,512,4,_Graph512x512c16);
      _Graph512x512c256 : AddModeGrafWord(512,512,8,_Graph512x512c256);
        _Graph640x200c2 : AddModeGrafWord(640,200,1,_Graph640x200c2);
        _Graph640x200c4 : AddModeGrafWord(640,200,2,_Graph640x200c4);
       _Graph640x200c16 : AddModeGrafWord(640,200,4,_Graph640x200c16);
        _Graph640x350c4 : AddModeGrafWord(640,350,2,_Graph640x350c4);
       _Graph640x350c16 : AddModeGrafWord(640,350,4,_Graph640x350c16);
      _Graph640x350c256 : AddModeGrafWord(640,350,8,_Graph640x350c256);
    _Graph640x350c32768 : AddModeGrafWord(640,350,15,_Graph640x350c32768);
        _Graph640x400c2 : AddModeGrafWord(640,400,1,_Graph640x400c2);
       _Graph640x400c16 : AddModeGrafWord(640,400,4,_Graph640x400c16);
      _Graph640x400c256 : AddModeGrafWord(640,400,8,_Graph640x400c256);
    _Graph640x400c32768 : AddModeGrafWord(640,400,15,_Graph640x400c32768);
       _Graph640x462c16 : AddModeGrafWord(640,462,4,_Graph640x462c16);
        _Graph640x480c2 : AddModeGrafWord(640,480,1,_Graph640x480c2);
       _Graph640x480c16 : AddModeGrafWord(640,480,4,_Graph640x480c16);
      _Graph640x480c256 : AddModeGrafWord(640,480,8,_Graph640x480c256);
    _Graph640x480c32768 : AddModeGrafWord(640,480,15,_Graph640x480c32768);
	_Graph720x350c2 : AddModeGrafWord(720,350,1,_Graph720x350c2);
       _Graph720x392c16 : AddModeGrafWord(720,392,4,_Graph720x392c16);
       _Graph720x512c16 : AddModeGrafWord(720,512,4,_Graph720x512c16);
      _Graph720x512c256 : AddModeGrafWord(720,512,8,_Graph720x512c256);
       _Graph720x540c16 : AddModeGrafWord(720,540,4,_Graph720x540c16);
      _Graph720x540c256 : AddModeGrafWord(720,540,8,_Graph720x540c256);
       _Graph752x410c16 : AddModeGrafWord(752,410,4,_Graph752x410c16);
      _Graph768x1024c16 : AddModeGrafWord(768,1024,4,_Graph768x1024c16);
       _Graph800x560c16 : AddModeGrafWord(800,560,4,_Graph800x560c16);
        _Graph800x600c2 : AddModeGrafWord(800,600,1,_Graph800x600c2);
       _Graph800x600c16 : AddModeGrafWord(800,600,4,_Graph800x600c16);
      _Graph800x600c256 : AddModeGrafWord(800,600,8,_Graph800x600c256);
    _Graph800x600c32768 : AddModeGrafWord(800,600,15,_Graph800x600c32768);
       _Graph960x720c16 : AddModeGrafWord(960,720,4,_Graph960x720c16);
       _Graph1024x768c2 : AddModeGrafWord(1024,768,1,_Graph1024x768c2);
       _Graph1024x768c4 : AddModeGrafWord(1024,768,2,_Graph1024x768c4);
      _Graph1024x768c16 : AddModeGrafWord(1024,768,4,_Graph1024x768c16);
     _Graph1024x768c256 : AddModeGrafWord(1024,768,8,_Graph1024x768c256);
    End;
   End;
  End;
  SelectVideoMode := Run;
  Done;
 End;
End;

Procedure VideoInfo;
Var W:Wins; Key:String; Size:Long; PChr:PChar; SizeOf_:Word;
Begin
 Key2Str(KeyOk,Key);
 With W do
 Begin
  InitO(52,12);
  PushWn;
  PutWn('Information Vid‚o',CurrColors.Dialog.Wins);
  Ln;
  PutTxt('Carte vid‚o   : ');
  PChr := AllocFunc(PVid1^.Card,SetPath4AddFile(StrPas(PathSystems))+'FRANCAIS.*',SizeOf_);
  PutPTxtLn(PChr);
  FreeMem(PChr,SizeOf_);
  PutTxt('Moniteur      : ');
  Case GetVideoMonitor of
		   mo3295 : PutTxtLn('3295');
		   mo5151 : PutTxtLn('5151');
		   mo5272 : PutTxtLn('5272');
		   mo5279 : PutTxtLn('5279');
		mo5379C01 : PutTxtLn('5379C01');
		mo5379M01 : PutTxtLn('5379M01');
		   mo8514 : PutTxtLn('8514');
		 moAnalog : PutTxtLn('Analog');
	    moAnalogColor : PutTxtLn('Analog couleur');
       moAnalogMonochrome : PutTxtLn('Analog monochrome');
	moAnalogMultiSync : PutTxtLn('Analog MultiSync');
		    moCGA : PutTxtLn('CGA');
	   moDigitalColor : PutTxtLn('Digital couleur');
       moDigitalMultiSync : PutTxtLn('Digital MultiSync');
             moDigitalTTL : PutTxtLn('Digital TTL');
                    moEGA : PutTxtLn('EGA');
	      moFixedSync : PutTxtLn('Fixed Sync');
                    moMDA : PutTxtLn('MDA');
              moMultiSync : PutTxtLn('MultiSync');
            moMultiSync2A : PutTxtLn('MultiSync 2A');
                  moNEC3D : PutTxtLn('NEC 3D');
           moNECMultiSync : PutTxtLn('NEC MultiSync');
               moRGBColor : PutTxtLn('RGB Couleur');
              moSeiko1430 : PutTxtLn('Seiko 1430');
         moSuperMultiSync : PutTxtLn('Super MultiSync');
               moSuperVGA : PutTxtLn('Super VGA');
         moTatungOmniScan : PutTxtLn('Tatung OmniScan');
	     moTTLDigital : PutTxtLn('TTL Digital');
          moTTLMonochrome : PutTxtLn('TTL Monochrome');
                  moTVM2A : PutTxtLn('TVM2A');
                  moTVM3A : PutTxtLn('TVM3A');
                  moTVM3M : PutTxtLn('TVM3M');
                    moVGA : PutTxtLn('VGA');
  End;
  PutTxt('M‚moire vid‚o : '+Str(GetVideoMemKb)+'Ko ');
  If(VSwpInit)Then
   PutTxtLn('(Libre : '+Str(VSwp[__VRAM].GetFree div 1024)+'Ko)')
  Else
   Ln;
  Ln;
  Case IVid.Graf of
   True : Case IVid.BitsPerPixel of
	   4 : Size := ((IVid.NmXPixels * IVid.NmYPixels) div 2) div 1024;
	   8 : Size := Long(Long(IVid.NmXPixels) * Long(IVid.NmYPixels)) div 1024;
	  Else Size := GetRealSizeScreen div 1024;
	  End;
     Else Begin
	   Size := (IVid.NmXTxts * IVid.NmYTxts) * 2;
	   If(Size mod 1024 > 0)Then Size := (Size div 1024) + 1
				Else Size := Size div 1024;
	  End;
  End;
  PutTxt('Mode vid‚o    : ');
  Case IVid.Graf of
   False : Begin
	    PutTxt('Texte ' + Str(IVid.NmXTxts)+'x'+ Str(IVid.NmYTxts));
	    Case IsMonochrome of
	     True : PutTxtLn(', mono');
	       Else PutTxtLn(', 16 couleurs');
	    End;
	   End;
      Else Begin
	    PutTxtLn('Graphiques ' + Str(IVid.NmXPixels)+
		     'x' + Str(IVid.NmYPixels) + ', ' +
		     Str(1 shl IVid.BitsPerPixel) + ' couleurs');
	   End;
  End;
  PutTxt('Nombre pages  : ');
  PutTxt(Str(GetVideoMemKb div Size));
  PutTxtLn(' (Taille : ' + Str(Size)+'Ko)');
  PutTxt('Taille carac. : ');
  PutTxtLn('8x'+Str(IVid.HeightChr));
  GetkHorDn(Key);
  Done;
 End;
End;

Procedure VideoSetup;
Var W     : Ansi;
    LC,LM : LstMnu;
    MC    : LstMnu;
    I,P   : Byte;
    Chr   : Char;
    SizeOf_:Word; PChr:PChar;
    ChkModeSupport:Procedure(Info1,Info2:PhysicalInfoVideo;Var Buf1,Buf2:PaletteMode);
    Ptr:Pointer Absolute ChkModeSupport;
    Mode,Mode2:PaletteMode;
Begin
 W.InitO(70,19);
 W.PushWn;
 W.PutWn('Configuration Vid‚o Primaire',CurrColors.Dialog.Wins);
 W.SubList(0,0,35,4,'Carte Vid‚o',LC);
 With LC do
 Begin
  For I := 0 to 103 do
  Begin
   PChr := AllocFunc(I,SetPath4AddFile(StrPas(PathSystems))+'FRANCAIS.*',SizeOf_);
   AddPChrByte(PChr,I);
  End;
 End;
 W.SubList(0,0,35,4,'Mode Vid‚o',LM);
 Ptr := AllocMainFunc(142,SizeOf_);
 ChkModeSupport(_PVid1,_PVid2,Mode,Mode2);
 FreeMem(Ptr,SizeOf_);
 For I := 0 to 127 do With LM do
 Begin
  If(Mode[I] = _NoMode)Then Break;
  Case Mode[I] of
        _TextBW40 : AddModeTextWord(40,25,'B',_TextBW40);
        _TextBW80 : AddModeTextWord(80,25,'B',_TextBW80);
         _TextC40 : AddModeTextWord(40,25,'C',_TextC40);
         _TextC80 : AddModeTextWord(80,25,'C',_TextC80);
      _TextC80x30 : AddModeTextWord(80,30,'C',_TextC80x30);
      _TextC80x33 : AddModeTextWord(80,33,'C',_TextC80x33);
      _TextC80x34 : AddModeTextWord(80,34,'C',_TextC80x34);
      _TextC80x43 : AddModeTextWord(80,43,'C',_TextC80x43);
      _TextC80x50 : AddModeTextWord(80,50,'C',_TextC80x50);
      _TextC80x60 : AddModeTextWord(80,60,'C',_TextC80x60);
      _TextC80x66 : AddModeTextWord(80,66,'C',_TextC80x66);
     _TextC100x30 : AddModeTextWord(100,30,'C',_TextC100x30);
     _TextC100x40 : AddModeTextWord(100,40,'C',_TextC100x40);
     _TextC100x50 : AddModeTextWord(100,50,'C',_TextC100x50);
     _TextC100x60 : AddModeTextWord(100,60,'C',_TextC100x60);
     _TextC100x75 : AddModeTextWord(100,75,'C',_TextC100x75);
     _TextC120x25 : AddModeTextWord(120,25,'C',_TextC120x25);
     _TextC120x43 : AddModeTextWord(120,43,'C',_TextC120x43);
     _TextC132x25 : AddModeTextWord(132,25,'C',_TextC132x25);
     _TextC132x28 : AddModeTextWord(132,28,'C',_TextC132x28);
     _TextC132x30 : AddModeTextWord(132,30,'C',_TextC132x30);
     _TextC132x43 : AddModeTextWord(132,43,'C',_TextC132x43);
     _TextC132x44 : AddModeTextWord(132,44,'C',_TextC132x44);
     _TextC132x50 : AddModeTextWord(132,50,'C',_TextC132x50);
     _TextC132x60 : AddModeTextWord(132,60,'C',_TextC132x60);
     _TextC160x50 : AddModeTextWord(160,50,'C',_TextC160x50);
        _TextMono : AddModeTextWord(80,25,'M',_TextMono);
  _TextMono132x25 : AddModeTextWord(132,25,'M',_TextMono132x25);
  _TextMono132x28 : AddModeTextWord(132,28,'M',_TextMono132x28);
  _TextMono132x43 : AddModeTextWord(132,43,'M',_TextMono132x43);
  _TextMono132x44 : AddModeTextWord(132,44,'M',_TextMono132x44);
	       _Hercule : AddStrWord('Hercule (720x348)',_Hercule);
        _Graph240x128c2 : AddModeGrafWord(240,128,1,_Graph240x128c2);
        _Graph320x200c4 : AddModeGrafWord(320,200,2,_Graph320x200c4);
       _Graph320x200c16 : AddModeGrafWord(320,200,4,_Graph320x200c16);
      _Graph320x200c256 : AddModeGrafWord(320,200,8,_Graph320x200c256);
    _Graph320x200c32768 : AddModeGrafWord(320,200,15,_Graph320x200c32768);
    _Graph320x200c65536 : AddModeGrafWord(320,200,16,_Graph320x200c65536);
      _Graph320x400c256 : AddModeGrafWord(320,400,8,_Graph320x400c256);
      _Graph360x480c256 : AddModeGrafWord(360,480,8,_Graph360x480c256);
       _Graph512x512c16 : AddModeGrafWord(512,512,4,_Graph512x512c16);
      _Graph512x512c256 : AddModeGrafWord(512,512,8,_Graph512x512c256);
        _Graph640x200c2 : AddModeGrafWord(640,200,1,_Graph640x200c2);
	_Graph640x200c4 : AddModeGrafWord(640,200,2,_Graph640x200c4);
       _Graph640x200c16 : AddModeGrafWord(640,200,4,_Graph640x200c16);
        _Graph640x350c4 : AddModeGrafWord(640,350,2,_Graph640x350c4);
       _Graph640x350c16 : AddModeGrafWord(640,350,4,_Graph640x350c16);
      _Graph640x350c256 : AddModeGrafWord(640,350,8,_Graph640x350c256);
    _Graph640x350c32768 : AddModeGrafWord(640,350,15,_Graph640x350c32768);
        _Graph640x400c2 : AddModeGrafWord(640,400,1,_Graph640x400c2);
       _Graph640x400c16 : AddModeGrafWord(640,400,4,_Graph640x400c16);
      _Graph640x400c256 : AddModeGrafWord(640,400,8,_Graph640x400c256);
    _Graph640x400c32768 : AddModeGrafWord(640,400,15,_Graph640x400c32768);
       _Graph640x462c16 : AddModeGrafWord(640,462,4,_Graph640x462c16);
        _Graph640x480c2 : AddModeGrafWord(640,480,1,_Graph640x480c2);
       _Graph640x480c16 : AddModeGrafWord(640,480,4,_Graph640x480c16);
      _Graph640x480c256 : AddModeGrafWord(640,480,8,_Graph640x480c256);
    _Graph640x480c32768 : AddModeGrafWord(640,480,15,_Graph640x480c32768);
        _Graph720x350c2 : AddModeGrafWord(720,350,1,_Graph720x350c2);
       _Graph720x392c16 : AddModeGrafWord(720,392,4,_Graph720x392c16);
       _Graph720x512c16 : AddModeGrafWord(720,512,4,_Graph720x512c16);
      _Graph720x512c256 : AddModeGrafWord(720,512,8,_Graph720x512c256);
       _Graph720x540c16 : AddModeGrafWord(720,540,4,_Graph720x540c16);
      _Graph720x540c256 : AddModeGrafWord(720,540,8,_Graph720x540c256);
       _Graph752x410c16 : AddModeGrafWord(752,410,4,_Graph752x410c16);
      _Graph768x1024c16 : AddModeGrafWord(768,1024,4,_Graph768x1024c16);
       _Graph800x560c16 : AddModeGrafWord(800,560,4,_Graph800x560c16);
        _Graph800x600c2 : AddModeGrafWord(800,600,1,_Graph800x600c2);
       _Graph800x600c16 : AddModeGrafWord(800,600,4,_Graph800x600c16);
      _Graph800x600c256 : AddModeGrafWord(800,600,8,_Graph800x600c256);
    _Graph800x600c32768 : AddModeGrafWord(800,600,15,_Graph800x600c32768);
       _Graph960x720c16 : AddModeGrafWord(960,720,4,_Graph960x720c16);
       _Graph1024x768c2 : AddModeGrafWord(1024,768,1,_Graph1024x768c2);
       _Graph1024x768c4 : AddModeGrafWord(1024,768,2,_Graph1024x768c4);
      _Graph1024x768c16 : AddModeGrafWord(1024,768,4,_Graph1024x768c16);
     _Graph1024x768c256 : AddModeGrafWord(1024,768,8,_Graph1024x768c256);
  End;
 End;
 If(CheckSvga)Then Chr := 'x'
	      Else Chr := ' ';
 W.PutTxtXY(0,6,'D‚tection Super VGA ['+Chr+']');
 W.PutTxtXY(35,6,'M‚moire vid‚o');
 W.SetKr($8F);
 W.BarSpcHorShade(49,6,W.MaxXTxts-1);
 W.PutTxtXY(49,6,Str(_PVid1.Memory div 1024));
 W.SubList(0,8,18,11,'Matrix Couleur',MC);
 MC.AddStrByte('Monochrome',1);
 MC.AddStrByte('Noir & Blanc',2);
 MC.AddStrByte('Bleuet',3);
 MC.AddStrByte('Diablo',4);
 MC.AddStrByte('Optionnel 1',5);
 MC.AddStrByte('Optionnel 2',6);
 W.PutkHorDn('Correcte|Annule');
 P := 0;
 W.GetkHorDn('Correcte|Annule');
 W.Done;
End;

BEGIN
END.